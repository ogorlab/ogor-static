---
import type { GetStaticPaths } from "astro";
import { t } from "i18next";
import config from "astro.config.mjs"

export const getStaticPaths = (() => {
  const { locales, defaultLocale, routing } = config.i18n!
  
  let prefixDefaultLocale = false
  if (typeof routing === "object" && routing.prefixDefaultLocale) {
    prefixDefaultLocale = true
  }
  
  return locales.map(lang => {
    const key = "yield"
    let redirects = "/" + lang + "/" + key
    let path       = "/" + lang + "/" + t(key, { lng: lang, ns: "urls" })

    if (!prefixDefaultLocale && lang === defaultLocale) {
      path = path.replace("/" + lang, "")
    }

    return {
      params: { redirects },
      props: { path },
    }
  })
}) satisfies GetStaticPaths;

const { path } = Astro.props
const content = `0;url=${path}`
---
<meta http-equiv="refresh" content={content} />